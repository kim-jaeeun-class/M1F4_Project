<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Gemini ê³ ê°ì„¼í„° ì±—ë´‡</title>
</head>
<body>
  <h2>ğŸ“ ê³ ê°ì„¼í„° ì±—ë´‡</h2>
  <input type="text" id="userInput" placeholder="ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?" style="width: 300px;" />
  <button onclick="sendToGemini()">ì „ì†¡</button>
  <pre id="responseBox" style="margin-top: 20px; white-space: pre-wrap;"></pre>

  <script>
    const responseBox = document.getElementById("responseBox");
    const chatHistory = []; // ğŸ‘‰ ì´ì „ ëŒ€í™” ì €ì¥

    const systemPrompt = 
    "ëª¨ë“  ëŒ€ë‹µì€ ì •ì¤‘í•˜ê²Œ ë‹µ í•´ì¤˜. ëª¨ë¥´ëŠ” ë‚´ìš©ì€ 'ëª¨ë¥´ê² ìŠµë‹ˆë‹¤'ë¡œ ë‹µí•´."+
    "ë‹µì„ í• ë–„ 50ê¸€ì ë‚´ë¡œ ë‹µí•´ì¤˜";

    async function sendToGemini() {
      const userInput = document.getElementById("userInput").value;
      if (!userInput.trim()) return;

      document.getElementById("userInput").value = "";

      // ëŒ€í™” UIì— ì‚¬ìš©ì ì§ˆë¬¸ ì¶”ê°€
      appendToChat("ğŸ™‹â€â™€ï¸ ê³ ê°", userInput);

      // ğŸ” ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ëŠ” í•­ìƒ ì²« ë©”ì‹œì§€ë¡œ
      const payload = {
        contents: [
          { role: "user", parts: [{ text: systemPrompt }] },
          ...chatHistory,
          { role: "user", parts: [{ text: userInput }] }
        ]
      };

      try {
        const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=AIzaSyCf3N7eOMox1_CRZw02w8PitkcfR59J4QQ`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(payload)
        });

        const data = await res.json();
        const botReply = data?.candidates?.[0]?.content?.parts?.[0]?.text || "âŒ ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤.";

        // ëŒ€í™” UIì— ì±—ë´‡ ì‘ë‹µ ì¶”ê°€
        appendToChat("ğŸ¤– ì±—ë´‡", botReply);

        // ğŸ‘‰ ëŒ€í™” íˆìŠ¤í† ë¦¬ì— ì§ˆë¬¸/ë‹µë³€ ì €ì¥
        chatHistory.push(
          { role: "user", parts: [{ text: userInput }] },
          { role: "model", content: { parts: [{ text: botReply }] } }
        );
      } catch (err) {
        console.error("ì—ëŸ¬:", err);
        appendToChat("âš ï¸ ì‹œìŠ¤í…œ", "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      }
    }

    function appendToChat(speaker, message) {
      responseBox.textContent += `${speaker}: ${message}\n\n`;
    }
  </script>
</body>
</html>
